services:
  # Serviço do Backend Node (Express + Prisma + SQLite)
  node-backend:
    build: ./petshop-backend
    container_name: petshop_node_backend
    restart: always
    ports:
      - "3000:3000"
      - "5555:5555"  # Porta extra para depuração, se necessário
    # No bind-mount here so the container uses the image's installed dependencies
    environment:
      NODE_ENV: production

  # Serviço da View (frontend estático servido por nginx)
  frontend:
    image: nginx:alpine
    container_name: petshop_frontend
    restart: always
    ports:
      - "5500:80"
    volumes:
      - ./frontend:/usr/share/nginx/html:ro
    depends_on:
      - node-backend

# Volumes: nenhum volume externo necessário para SQLite (o arquivo `prisma/dev.db` está versionado no repo)
volumes: {}
